python3 /content/repository/src/run_experiment.py --experiment_path experiments --experiment_name gft_3 gft_m -D datasets --download

==== Start Main ====
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to datasets/CIFAR10/train/cifar-10-python.tar.gz
Extracting datasets/CIFAR10/train/cifar-10-python.tar.gz to datasets/CIFAR10/train
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to datasets/CIFAR10/test/cifar-10-python.tar.gz
Extracting datasets/CIFAR10/test/cifar-10-python.tar.gz to datasets/CIFAR10/test
Dataset: CIFAR10
{'train': 41666, 'val': 8334, 'test': 10000}
Model Architecture:  fvit_monolith
Class weights: tensor([1.0001, 0.9999, 0.9999, 0.9999, 0.9999, 0.9999, 0.9999, 1.0001, 1.0001,
        1.0001], dtype=torch.float64)
=======================================================================================================================================================================================================================
Layer (type:depth-idx)                   Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds                 Trainable
=======================================================================================================================================================================================================================
VisionTransformer                        [8, 3, 32, 32]            [8, 10]                   --                             --                   --                        --                        True
├─ModuleList: 1-1                        --                        --                        --                             --                   --                        --                        True
│    └─Conv2d: 2-1                       [8, 3, 32, 32]            [8, 64, 16, 16]           832                         0.31%                   [2, 2]                    1,703,936                 True
│    └─Conv2d: 2-2                       [8, 3, 32, 32]            [8, 64, 8, 8]             3,136                       1.15%                   [4, 4]                    1,605,632                 True
│    └─Conv2d: 2-3                       [8, 3, 32, 32]            [8, 64, 4, 4]             12,352                      4.54%                   [8, 8]                    1,581,056                 True
│    └─Conv2d: 2-4                       [8, 3, 32, 32]            [8, 64, 2, 2]             49,216                     18.07%                   [16, 16]                  1,574,912                 True
├─Encoder: 1-2                           [8, 340, 64]              [8, 340, 64]              21,760                      7.99%                   --                        --                        True
│    └─Dropout: 2-5                      [8, 340, 64]              [8, 340, 64]              --                             --                   --                        --                        --
│    └─Sequential: 2-6                   [8, 340, 64]              [8, 340, 64]              --                             --                   --                        --                        True
│    │    └─SpectralBlock: 3-1           [8, 340, 64]              [8, 340, 64]              58,944                     21.64%                   --                        3,011,072                 True
│    │    └─SpectralBlock: 3-2           [8, 340, 64]              [8, 340, 64]              58,944                     21.64%                   --                        3,011,072                 True
│    │    └─SpectralBlock: 3-3           [8, 340, 64]              [8, 340, 64]              58,944                     21.64%                   --                        3,011,072                 True
│    └─LayerNorm: 2-7                    [8, 340, 64]              [8, 340, 64]              128                         0.05%                   --                        1,024                     True
├─Conv1d: 1-3                            [8, 340, 64]              [8, 18, 64]               6,138                       2.25%                   [1]                       3,142,656                 True
├─MLP: 1-4                               [8, 18, 64]               [8, 18, 8]                --                             --                   --                        --                        True
│    └─Linear: 2-8                       [8, 18, 64]               [8, 18, 8]                520                         0.19%                   --                        4,160                     True
│    └─Dropout: 2-9                      [8, 18, 8]                [8, 18, 8]                --                             --                   --                        --                        --
├─Sequential: 1-5                        [8, 144]                  [8, 10]                   --                             --                   --                        --                        True
│    └─Linear: 2-10                      [8, 144]                  [8, 10]                   1,450                       0.53%                   --                        11,600                    True
=======================================================================================================================================================================================================================
Total params: 272,364
Trainable params: 272,364
Non-trainable params: 0
Total mult-adds (M): 18.66
=======================================================================================================================================================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 37.03
Params size (MB): 1.00
Estimated Total Size (MB): 38.13
=======================================================================================================================================================================================================================
Initializing Experiments
Training

--------------------
Epoch 1 / 50
--------------------
Learning Rate: 0.0001
Epoch 1 | Time Elapsed: 78.56420707702637 |
                      Train | Accuracy: 0.4341 | Loss: 1.5323
                 Validation | Accuracy: 0.5120 | Loss: 1.3498

--------------------
Epoch 2 / 50
--------------------
Learning Rate: 9.990133642141359e-05
Epoch 2 | Time Elapsed: 78.30272340774536 |
                      Train | Accuracy: 0.5592 | Loss: 1.2277
                 Validation | Accuracy: 0.5592 | Loss: 1.2290

--------------------
Epoch 3 / 50
--------------------
Learning Rate: 9.96057350657239e-05
Epoch 3 | Time Elapsed: 78.59098982810974 |
                      Train | Accuracy: 0.6152 | Loss: 1.0779
                 Validation | Accuracy: 0.5802 | Loss: 1.1793

--------------------
Epoch 4 / 50
--------------------
Learning Rate: 9.911436253643444e-05
Epoch 4 | Time Elapsed: 78.77423167228699 |
                      Train | Accuracy: 0.6630 | Loss: 0.9499
                 Validation | Accuracy: 0.5940 | Loss: 1.1852

--------------------
Epoch 5 / 50
--------------------
Learning Rate: 9.842915805643155e-05
Epoch 5 | Time Elapsed: 77.85894536972046 |
                      Train | Accuracy: 0.7106 | Loss: 0.8259
                 Validation | Accuracy: 0.5816 | Loss: 1.2418

--------------------
Epoch 6 / 50
--------------------
Learning Rate: 9.755282581475769e-05
Epoch 6 | Time Elapsed: 77.44583868980408 |
                      Train | Accuracy: 0.7510 | Loss: 0.7044
                 Validation | Accuracy: 0.5738 | Loss: 1.3084

--------------------
Epoch 7 / 50
--------------------
Learning Rate: 9.648882429441257e-05
Epoch 7 | Time Elapsed: 78.48414444923401 |
                      Train | Accuracy: 0.7961 | Loss: 0.5836
                 Validation | Accuracy: 0.5767 | Loss: 1.4174

--------------------
Epoch 8 / 50
--------------------
Learning Rate: 9.524135262330098e-05
Epoch 8 | Time Elapsed: 78.0271942615509 |
                      Train | Accuracy: 0.8313 | Loss: 0.4734
                 Validation | Accuracy: 0.5757 | Loss: 1.5485

--------------------
Epoch 9 / 50
--------------------
Learning Rate: 9.381533400219317e-05
Epoch 9 | Time Elapsed: 77.90795421600342 |
                      Train | Accuracy: 0.8656 | Loss: 0.3832
                 Validation | Accuracy: 0.5701 | Loss: 1.7007

--------------------
Epoch 10 / 50
--------------------
Learning Rate: 9.221639627510075e-05
Epoch 10 | Time Elapsed: 77.91652536392212 |
                      Train | Accuracy: 0.8915 | Loss: 0.3069
                 Validation | Accuracy: 0.5500 | Loss: 1.9416

--------------------
Epoch 11 / 50
--------------------
Learning Rate: 9.045084971874735e-05
Epoch 11 | Time Elapsed: 78.43835639953613 |
                      Train | Accuracy: 0.9121 | Loss: 0.2480
                 Validation | Accuracy: 0.5587 | Loss: 2.1637

--------------------
Epoch 12 / 50
--------------------
Learning Rate: 8.852566213878945e-05
Epoch 12 | Time Elapsed: 77.8385853767395 |
                      Train | Accuracy: 0.9299 | Loss: 0.1997
                 Validation | Accuracy: 0.5449 | Loss: 2.3456

--------------------
Epoch 13 / 50
--------------------
Learning Rate: 8.644843137107056e-05
Epoch 13 | Time Elapsed: 78.20093441009521 |
                      Train | Accuracy: 0.9396 | Loss: 0.1747
                 Validation | Accuracy: 0.5475 | Loss: 2.4376

--------------------
Epoch 14 / 50
--------------------
Learning Rate: 8.422735529643442e-05
Epoch 14 | Time Elapsed: 77.3494176864624 |
                      Train | Accuracy: 0.9480 | Loss: 0.1488
                 Validation | Accuracy: 0.5533 | Loss: 2.5367

--------------------
Epoch 15 / 50
--------------------
Learning Rate: 8.187119948743447e-05
Epoch 15 | Time Elapsed: 77.7193591594696 |
                      Train | Accuracy: 0.9534 | Loss: 0.1301
                 Validation | Accuracy: 0.5548 | Loss: 2.6399

--------------------
Epoch 16 / 50
--------------------
Learning Rate: 7.938926261462366e-05
Epoch 16 | Time Elapsed: 77.88071274757385 |
                      Train | Accuracy: 0.9613 | Loss: 0.1118
                 Validation | Accuracy: 0.5505 | Loss: 2.8098

--------------------
Epoch 17 / 50
--------------------
Learning Rate: 7.679133974894982e-05
Epoch 17 | Time Elapsed: 78.05630016326904 |
                      Train | Accuracy: 0.9644 | Loss: 0.0985
                 Validation | Accuracy: 0.5487 | Loss: 2.9424

--------------------
Epoch 18 / 50
--------------------
Learning Rate: 7.408768370508575e-05
Epoch 18 | Time Elapsed: 76.9253294467926 |
                      Train | Accuracy: 0.9695 | Loss: 0.0868
                 Validation | Accuracy: 0.5517 | Loss: 2.9289

--------------------
Epoch 19 / 50
--------------------
Learning Rate: 7.128896457825361e-05
Epoch 19 | Time Elapsed: 77.11628317832947 |
                      Train | Accuracy: 0.9730 | Loss: 0.0778
                 Validation | Accuracy: 0.5452 | Loss: 2.9906

--------------------
Epoch 20 / 50
--------------------
Learning Rate: 6.840622763423389e-05
Epoch 20 | Time Elapsed: 76.40999174118042 |
                      Train | Accuracy: 0.9750 | Loss: 0.0710
                 Validation | Accuracy: 0.5402 | Loss: 3.1317

--------------------
Epoch 21 / 50
--------------------
Learning Rate: 6.545084971874736e-05
Epoch 21 | Time Elapsed: 77.11569809913635 |
                      Train | Accuracy: 0.9792 | Loss: 0.0626
                 Validation | Accuracy: 0.5502 | Loss: 3.1500

--------------------
Epoch 22 / 50
--------------------
Learning Rate: 6.243449435824272e-05
Epoch 22 | Time Elapsed: 75.93488478660583 |
                      Train | Accuracy: 0.9831 | Loss: 0.0521
                 Validation | Accuracy: 0.5559 | Loss: 3.2128

--------------------
Epoch 23 / 50
--------------------
Learning Rate: 5.9369065729286224e-05
Epoch 23 | Time Elapsed: 76.42026209831238 |
                      Train | Accuracy: 0.9839 | Loss: 0.0496
                 Validation | Accuracy: 0.5472 | Loss: 3.3206

--------------------
Epoch 24 / 50
--------------------
Learning Rate: 5.626666167821521e-05
Epoch 24 | Time Elapsed: 76.5316252708435 |
                      Train | Accuracy: 0.9857 | Loss: 0.0420
                 Validation | Accuracy: 0.5475 | Loss: 3.3042

--------------------
Epoch 25 / 50
--------------------
Learning Rate: 5.3139525976465657e-05
Epoch 25 | Time Elapsed: 76.76547980308533 |
                      Train | Accuracy: 0.9883 | Loss: 0.0356
                 Validation | Accuracy: 0.5470 | Loss: 3.3522
Early Stopping...
Best IoU score: None
--------------------
Test Loss 1.1520300299286843
Test Accuracy 0.598
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<07:55, 358315.18it/s]  0%|          | 229376/170498071 [00:00<04:13, 670705.88it/s]  1%|          | 917504/170498071 [00:00<01:21, 2070077.14it/s]  2%|▏         | 2752512/170498071 [00:00<00:26, 6323322.93it/s]  3%|▎         | 5505024/170498071 [00:00<00:13, 12084282.16it/s]  5%|▌         | 9043968/170498071 [00:00<00:08, 18591536.46it/s]  7%|▋         | 12713984/170498071 [00:00<00:06, 23740667.03it/s]  9%|▉         | 15892480/170498071 [00:01<00:06, 22457638.55it/s] 11%|█         | 19169280/170498071 [00:01<00:06, 24963073.50it/s] 13%|█▎        | 22478848/170498071 [00:01<00:05, 27131300.48it/s] 15%|█▌        | 26083328/170498071 [00:01<00:04, 29602378.60it/s] 17%|█▋        | 29687808/170498071 [00:01<00:04, 31435427.59it/s] 20%|█▉        | 33325056/170498071 [00:01<00:04, 32829300.25it/s] 22%|██▏       | 36896768/170498071 [00:01<00:03, 33649991.71it/s] 24%|██▍       | 40501248/170498071 [00:01<00:03, 34342914.04it/s] 26%|██▌       | 44007424/170498071 [00:01<00:04, 31093566.09it/s] 28%|██▊       | 47349760/170498071 [00:02<00:03, 31646745.05it/s] 30%|██▉       | 50659328/170498071 [00:02<00:03, 31999365.68it/s] 32%|███▏      | 53936128/170498071 [00:02<00:03, 32165000.61it/s] 34%|███▎      | 57212928/170498071 [00:02<00:03, 32178920.00it/s] 35%|███▌      | 60456960/170498071 [00:02<00:03, 31081828.08it/s] 38%|███▊      | 64028672/170498071 [00:02<00:03, 32407518.20it/s] 40%|███▉      | 67633152/170498071 [00:02<00:03, 33464091.10it/s] 42%|████▏     | 71172096/170498071 [00:02<00:02, 34019119.11it/s] 44%|████▍     | 74711040/170498071 [00:02<00:02, 34401755.22it/s] 46%|████▌     | 78315520/170498071 [00:02<00:02, 34671941.90it/s] 48%|████▊     | 81821696/170498071 [00:03<00:02, 33984302.12it/s] 50%|████▉     | 85229568/170498071 [00:03<00:02, 33257293.42it/s] 52%|█████▏    | 88571904/170498071 [00:03<00:02, 30196299.38it/s] 54%|█████▍    | 91783168/170498071 [00:03<00:02, 30700097.11it/s] 56%|█████▌    | 95092736/170498071 [00:03<00:02, 31291987.00it/s] 58%|█████▊    | 98402304/170498071 [00:03<00:02, 31736747.86it/s] 60%|█████▉    | 102006784/170498071 [00:03<00:02, 32976473.65it/s] 62%|██████▏   | 105545728/170498071 [00:03<00:01, 33678409.93it/s] 64%|██████▍   | 109117440/170498071 [00:03<00:01, 34261760.05it/s] 66%|██████▌   | 112623616/170498071 [00:04<00:01, 34493852.44it/s] 68%|██████▊   | 116228096/170498071 [00:04<00:01, 34949030.61it/s] 70%|███████   | 119734272/170498071 [00:04<00:01, 32461696.22it/s] 72%|███████▏  | 123043840/170498071 [00:04<00:01, 32283639.96it/s] 74%|███████▍  | 126353408/170498071 [00:04<00:01, 32475638.28it/s] 76%|███████▌  | 129695744/170498071 [00:04<00:01, 32611267.94it/s] 78%|███████▊  | 132972544/170498071 [00:04<00:01, 30380762.23it/s] 80%|████████  | 136577024/170498071 [00:04<00:01, 31953298.79it/s] 82%|████████▏ | 140181504/170498071 [00:04<00:00, 33101489.34it/s] 84%|████████▍ | 143753216/170498071 [00:04<00:00, 33842894.02it/s] 86%|████████▋ | 147226624/170498071 [00:05<00:00, 34089251.95it/s] 88%|████████▊ | 150831104/170498071 [00:05<00:00, 34649068.87it/s] 91%|█████████ | 154337280/170498071 [00:05<00:00, 33997557.92it/s] 93%|█████████▎| 157777920/170498071 [00:05<00:00, 32074718.92it/s] 94%|█████████▍| 161021952/170498071 [00:05<00:00, 31123076.01it/s] 96%|█████████▋| 164298752/170498071 [00:05<00:00, 31433208.14it/s] 98%|█████████▊| 167477248/170498071 [00:05<00:00, 30956001.91it/s]100%|██████████| 170498071/170498071 [00:05<00:00, 29361285.59it/s]
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<07:59, 355482.04it/s]  0%|          | 229376/170498071 [00:00<04:14, 668153.03it/s]  1%|          | 917504/170498071 [00:00<01:22, 2066088.88it/s]  2%|▏         | 2752512/170498071 [00:00<00:26, 6314309.34it/s]  3%|▎         | 5472256/170498071 [00:00<00:13, 11977124.70it/s]  5%|▌         | 9109504/170498071 [00:00<00:08, 18788938.67it/s]  7%|▋         | 12615680/170498071 [00:00<00:06, 23420156.32it/s]  9%|▉         | 15826944/170498071 [00:01<00:06, 22234273.71it/s] 11%|█         | 19136512/170498071 [00:01<00:06, 25011729.30it/s] 13%|█▎        | 22413312/170498071 [00:01<00:05, 27087408.14it/s] 15%|█▌        | 26017792/170498071 [00:01<00:04, 29588148.71it/s] 17%|█▋        | 29622272/170498071 [00:01<00:04, 31403726.93it/s] 19%|█▉        | 33193984/170498071 [00:01<00:04, 32633888.63it/s] 22%|██▏       | 36798464/170498071 [00:01<00:03, 33617858.92it/s] 24%|██▎       | 40271872/170498071 [00:01<00:03, 33941384.12it/s] 26%|██▌       | 43810816/170498071 [00:01<00:03, 34361796.56it/s] 28%|██▊       | 47284224/170498071 [00:02<00:03, 30992613.90it/s] 30%|██▉       | 50593792/170498071 [00:02<00:03, 31477469.15it/s] 32%|███▏      | 53837824/170498071 [00:02<00:03, 31707600.29it/s] 34%|███▎      | 57212928/170498071 [00:02<00:03, 30610273.54it/s] 36%|███▌      | 60784640/170498071 [00:02<00:03, 32035838.97it/s] 38%|███▊      | 64356352/170498071 [00:02<00:03, 33079096.18it/s] 40%|███▉      | 67895296/170498071 [00:02<00:03, 33734871.20it/s] 42%|████▏     | 71467008/170498071 [00:02<00:02, 34293702.25it/s] 44%|████▍     | 75071488/170498071 [00:02<00:02, 34800510.47it/s] 46%|████▌     | 78577664/170498071 [00:02<00:02, 33786014.80it/s] 48%|████▊     | 81985536/170498071 [00:03<00:02, 32675141.66it/s] 50%|█████     | 85295104/170498071 [00:03<00:02, 30509984.02it/s] 52%|█████▏    | 88539136/170498071 [00:03<00:02, 31016010.98it/s] 54%|█████▍    | 91750400/170498071 [00:03<00:02, 31289886.95it/s] 56%|█████▌    | 95092736/170498071 [00:03<00:02, 31833420.90it/s] 58%|█████▊    | 98369536/170498071 [00:03<00:02, 32043666.77it/s] 60%|█████▉    | 101908480/170498071 [00:03<00:02, 33002102.37it/s] 62%|██████▏   | 105512960/170498071 [00:03<00:01, 33864553.12it/s] 64%|██████▍   | 109051904/170498071 [00:03<00:01, 34289403.15it/s] 66%|██████▌   | 112558080/170498071 [00:04<00:01, 34173997.44it/s] 68%|██████▊   | 116064256/170498071 [00:04<00:01, 34432598.74it/s] 70%|███████   | 119537664/170498071 [00:04<00:01, 32546807.03it/s] 72%|███████▏  | 122847232/170498071 [00:04<00:01, 32518510.97it/s] 74%|███████▍  | 126124032/170498071 [00:04<00:01, 32581493.83it/s] 76%|███████▌  | 129400832/170498071 [00:04<00:01, 31802669.81it/s] 78%|███████▊  | 132644864/170498071 [00:04<00:01, 31404658.52it/s] 80%|███████▉  | 135823360/170498071 [00:04<00:01, 30464424.69it/s] 82%|████████▏ | 139395072/170498071 [00:04<00:00, 31951638.31it/s] 84%|████████▍ | 142901248/170498071 [00:04<00:00, 32806989.68it/s] 86%|████████▌ | 146636800/170498071 [00:05<00:00, 34113278.91it/s] 88%|████████▊ | 150077440/170498071 [00:05<00:00, 34003043.33it/s] 90%|█████████ | 153518080/170498071 [00:05<00:00, 33882853.43it/s] 92%|█████████▏| 157122560/170498071 [00:05<00:00, 34502436.69it/s] 94%|█████████▍| 160595968/170498071 [00:05<00:00, 32088745.69it/s] 96%|█████████▌| 163872768/170498071 [00:05<00:00, 31457787.44it/s] 98%|█████████▊| 167116800/170498071 [00:05<00:00, 31728570.51it/s]100%|█████████▉| 170360832/170498071 [00:05<00:00, 31742910.57it/s]100%|██████████| 170498071/170498071 [00:05<00:00, 29196027.01it/s]
